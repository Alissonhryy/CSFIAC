<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CSF Manager - Gestão de Cursos</title>
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <script src="https://html2canvas.hertzen.com/dist/html2canvas.min.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary: #2563eb;
            --primary-dark: #1d4ed8;
            --secondary: #64748b;
            --success: #22c55e;
            --warning: #f59e0b;
            --danger: #ef4444;
            --background: #f8fafc;
            --surface: #ffffff;
            --text: #1e293b;
            --text-light: #64748b;
            --border: #e2e8f0;
            --sidebar-width: 260px;
        }

        body {
            font-family: 'Segoe UI', system-ui, -apple-system, sans-serif;
            background: var(--background);
            color: var(--text);
            min-height: 100vh;
        }

        /* Login Page */
        .login-page {
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            background: linear-gradient(135deg, #1e3a8a 0%, #3b82f6 100%);
            padding: 20px;
        }

        .login-card {
            background: white;
            padding: 40px;
            border-radius: 16px;
            box-shadow: 0 25px 50px -12px rgba(0,0,0,0.25);
            width: 100%;
            max-width: 400px;
        }

        .login-header {
            text-align: center;
            margin-bottom: 32px;
        }

        .login-header h1 {
            font-size: 28px;
            color: var(--primary);
            margin-bottom: 8px;
        }

        .login-header p {
            color: var(--text-light);
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-label {
            display: block;
            font-weight: 500;
            margin-bottom: 8px;
            color: var(--text);
        }

        .form-input, .form-select {
            width: 100%;
            padding: 12px 16px;
            border: 2px solid var(--border);
            border-radius: 8px;
            font-size: 16px;
            transition: all 0.2s;
        }

        .form-input:focus, .form-select:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(37, 99, 235, 0.1);
        }

        .form-error {
            color: var(--danger);
            font-size: 12px;
            margin-top: 4px;
            display: none;
        }

        .form-error.show {
            display: block;
        }

        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 16px;
        }

        .btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s;
        }

        .btn-primary {
            background: var(--primary);
            color: white;
        }

        .btn-primary:hover {
            background: var(--primary-dark);
        }

        .btn-secondary {
            background: var(--background);
            color: var(--text);
            border: 1px solid var(--border);
        }

        .btn-secondary:hover {
            background: var(--border);
        }

        .btn-danger {
            background: var(--danger);
            color: white;
        }

        .btn-danger:hover {
            background: #dc2626;
        }

        .btn-icon {
            padding: 8px;
            min-width: 40px;
        }

        .btn-full {
            width: 100%;
        }

        /* Dashboard Layout */
        .dashboard {
            display: none;
            min-height: 100vh;
        }

        .dashboard.active {
            display: flex;
        }

        .sidebar {
            width: var(--sidebar-width);
            background: var(--surface);
            border-right: 1px solid var(--border);
            padding: 20px 0;
            position: fixed;
            height: 100vh;
            overflow-y: auto;
        }

        .sidebar-header {
            padding: 0 20px 20px;
            border-bottom: 1px solid var(--border);
            margin-bottom: 20px;
        }

        .sidebar-header h2 {
            font-size: 20px;
            color: var(--primary);
        }

        .sidebar-header p {
            font-size: 12px;
            color: var(--text-light);
        }

        .nav-menu {
            list-style: none;
        }

        .nav-item {
            padding: 12px 20px;
            display: flex;
            align-items: center;
            gap: 12px;
            cursor: pointer;
            transition: all 0.2s;
            color: var(--text-light);
            border-left: 3px solid transparent;
        }

        .nav-item:hover {
            background: var(--background);
            color: var(--text);
        }

        .nav-item.active {
            background: rgba(37, 99, 235, 0.1);
            color: var(--primary);
            border-left-color: var(--primary);
        }

        .nav-item .material-icons {
            font-size: 20px;
        }

        .nav-divider {
            height: 1px;
            background: var(--border);
            margin: 16px 0;
        }

        .main-content {
            flex: 1;
            margin-left: var(--sidebar-width);
            padding: 24px;
        }

        .page-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 24px;
        }

        .page-title {
            font-size: 28px;
            font-weight: 600;
        }

        .page-actions {
            display: flex;
            gap: 12px;
        }

        /* Cards */
        .card {
            background: var(--surface);
            border-radius: 12px;
            border: 1px solid var(--border);
            overflow: hidden;
        }

        .card-header {
            padding: 16px 20px;
            border-bottom: 1px solid var(--border);
            font-weight: 600;
        }

        .card-body {
            padding: 20px;
        }

        /* Stats Grid */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 16px;
            margin-bottom: 24px;
        }

        .stat-card {
            background: var(--surface);
            border-radius: 12px;
            padding: 20px;
            border: 1px solid var(--border);
        }

        .stat-icon {
            width: 48px;
            height: 48px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 12px;
        }

        .stat-icon.blue { background: rgba(37, 99, 235, 0.1); color: var(--primary); }
        .stat-icon.green { background: rgba(34, 197, 94, 0.1); color: var(--success); }
        .stat-icon.yellow { background: rgba(245, 158, 11, 0.1); color: var(--warning); }
        .stat-icon.red { background: rgba(239, 68, 68, 0.1); color: var(--danger); }

        .stat-value {
            font-size: 32px;
            font-weight: 700;
            margin-bottom: 4px;
        }

        .stat-label {
            color: var(--text-light);
            font-size: 14px;
        }

        /* Course Grid */
        .course-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
            gap: 16px;
        }

        .course-card {
            background: var(--surface);
            border-radius: 12px;
            border: 1px solid var(--border);
            overflow: hidden;
            transition: all 0.2s;
            cursor: pointer;
        }

        .course-card:hover {
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
            transform: translateY(-2px);
        }

        .course-header {
            padding: 16px;
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            border-bottom: 1px solid var(--border);
        }

        .course-title {
            font-weight: 600;
            font-size: 16px;
            margin-bottom: 4px;
        }

        .course-id {
            font-size: 12px;
            color: var(--text-light);
        }

        .course-actions {
            display: flex;
            gap: 4px;
        }

        .course-actions button {
            background: none;
            border: none;
            padding: 4px;
            cursor: pointer;
            color: var(--text-light);
            border-radius: 4px;
            transition: all 0.2s;
        }

        .course-actions button:hover {
            background: var(--background);
            color: var(--text);
        }

        .course-actions button.delete:hover {
            color: var(--danger);
        }

        .course-actions button.drive:hover {
            color: var(--success);
        }

        .course-info {
            padding: 16px;
        }

        .course-info-item {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-bottom: 8px;
            font-size: 14px;
            color: var(--text-light);
        }

        .course-info-item .material-icons {
            font-size: 18px;
        }

        .status-badge {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 500;
        }

        .status-badge.concluido {
            background: rgba(34, 197, 94, 0.1);
            color: var(--success);
        }

        .status-badge.andamento {
            background: rgba(37, 99, 235, 0.1);
            color: var(--primary);
        }

        .status-badge.pendente {
            background: rgba(245, 158, 11, 0.1);
            color: var(--warning);
        }

        .status-badge.cancelado {
            background: rgba(239, 68, 68, 0.1);
            color: var(--danger);
        }

        /* Instructor Cards */
        .instructor-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 16px;
        }

        .instructor-card {
            background: var(--surface);
            border-radius: 12px;
            border: 1px solid var(--border);
            padding: 24px;
            text-align: center;
        }

        .instructor-avatar {
            width: 64px;
            height: 64px;
            border-radius: 50%;
            background: var(--primary);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            font-weight: 600;
            margin: 0 auto 12px;
        }

        .instructor-name {
            font-weight: 600;
            font-size: 18px;
            margin-bottom: 4px;
        }

        .instructor-specialty {
            color: var(--text-light);
            font-size: 14px;
            margin-bottom: 12px;
        }

        .instructor-contact {
            display: flex;
            justify-content: center;
            gap: 8px;
            margin-bottom: 12px;
        }

        .instructor-contact-btn {
            display: flex;
            align-items: center;
            justify-content: center;
            width: 36px;
            height: 36px;
            border-radius: 50%;
            background: var(--background);
            color: var(--text-light);
            border: none;
            cursor: pointer;
            transition: all 0.2s;
        }

        .instructor-contact-btn:hover {
            background: var(--primary);
            color: white;
        }

        .instructor-contact-btn.whatsapp:hover {
            background: #25d366;
        }

        .instructor-stats {
            display: flex;
            justify-content: center;
            gap: 24px;
            padding-top: 12px;
            border-top: 1px solid var(--border);
        }

        .instructor-stat {
            text-align: center;
        }

        .instructor-stat-value {
            font-size: 20px;
            font-weight: 600;
            color: var(--primary);
        }

        .instructor-stat-label {
            font-size: 12px;
            color: var(--text-light);
        }

        .instructor-actions {
            display: flex;
            justify-content: center;
            gap: 8px;
            margin-top: 16px;
        }

        /* Calendar */
        .calendar-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .calendar-nav {
            display: flex;
            gap: 8px;
        }

        .calendar-grid {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 4px;
        }

        .calendar-day-header {
            text-align: center;
            font-weight: 600;
            padding: 8px;
            color: var(--text-light);
            font-size: 12px;
        }

        .calendar-day {
            aspect-ratio: 1;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.2s;
            font-size: 14px;
            position: relative;
        }

        .calendar-day:hover {
            background: var(--background);
        }

        .calendar-day.other-month {
            color: var(--text-light);
            opacity: 0.5;
        }

        .calendar-day.today {
            background: var(--primary);
            color: white;
        }

        .calendar-day.has-event::after {
            content: '';
            width: 6px;
            height: 6px;
            border-radius: 50%;
            background: var(--success);
            position: absolute;
            bottom: 4px;
        }

        /* Modal */
        .modal-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0,0,0,0.5);
            align-items: center;
            justify-content: center;
            z-index: 1000;
            padding: 20px;
        }

        .modal-overlay.active {
            display: flex;
        }

        .modal {
            background: white;
            border-radius: 16px;
            width: 100%;
            max-width: 500px;
            max-height: 90vh;
            overflow-y: auto;
        }

        .modal-header {
            padding: 20px;
            border-bottom: 1px solid var(--border);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .modal-header h3 {
            font-size: 18px;
        }

        .modal-close {
            background: none;
            border: none;
            cursor: pointer;
            color: var(--text-light);
        }

        .modal-body {
            padding: 20px;
        }

        .modal-footer {
            padding: 20px;
            border-top: 1px solid var(--border);
            display: flex;
            justify-content: flex-end;
            gap: 12px;
        }

        /* Settings */
        .settings-section {
            margin-bottom: 32px;
        }

        .settings-section h3 {
            font-size: 16px;
            margin-bottom: 16px;
            padding-bottom: 8px;
            border-bottom: 1px solid var(--border);
        }

        .settings-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px 0;
            border-bottom: 1px solid var(--border);
        }

        .settings-row:last-child {
            border-bottom: none;
        }

        .settings-info h4 {
            font-weight: 500;
            margin-bottom: 4px;
        }

        .settings-info p {
            font-size: 14px;
            color: var(--text-light);
        }

        /* Users Table */
        .users-table {
            width: 100%;
            border-collapse: collapse;
        }

        .users-table th,
        .users-table td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid var(--border);
        }

        .users-table th {
            background: var(--background);
            font-weight: 600;
            font-size: 12px;
            text-transform: uppercase;
            color: var(--text-light);
        }

        .users-table tr:hover {
            background: var(--background);
        }

        .role-badge {
            display: inline-block;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 12px;
            font-weight: 500;
        }

        .role-badge.admin {
            background: rgba(37, 99, 235, 0.1);
            color: var(--primary);
        }

        .role-badge.editor {
            background: rgba(34, 197, 94, 0.1);
            color: var(--success);
        }

        .role-badge.viewer {
            background: rgba(245, 158, 11, 0.1);
            color: var(--warning);
        }

        /* Activity Log */
        .activity-log {
            max-height: 400px;
            overflow-y: auto;
        }

        .activity-item {
            display: flex;
            gap: 12px;
            padding: 12px;
            border-bottom: 1px solid var(--border);
        }

        .activity-item:last-child {
            border-bottom: none;
        }

        .activity-icon {
            width: 36px;
            height: 36px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-shrink: 0;
        }

        .activity-icon.add { background: rgba(34, 197, 94, 0.1); color: var(--success); }
        .activity-icon.edit { background: rgba(37, 99, 235, 0.1); color: var(--primary); }
        .activity-icon.delete { background: rgba(239, 68, 68, 0.1); color: var(--danger); }
        .activity-icon.login { background: rgba(245, 158, 11, 0.1); color: var(--warning); }

        .activity-content {
            flex: 1;
        }

        .activity-title {
            font-weight: 500;
            margin-bottom: 2px;
        }

        .activity-user {
            font-size: 12px;
            color: var(--primary);
            font-weight: 500;
        }

        .activity-description {
            font-size: 14px;
            color: var(--text-light);
        }

        .activity-time {
            font-size: 12px;
            color: var(--text-light);
        }

        /* Toast */
        .toast-container {
            position: fixed;
            bottom: 20px;
            right: 20px;
            z-index: 2000;
        }

        .toast {
            background: var(--text);
            color: white;
            padding: 12px 20px;
            border-radius: 8px;
            margin-top: 8px;
            display: flex;
            align-items: center;
            gap: 8px;
            animation: slideIn 0.3s ease;
        }

        .toast.success { background: var(--success); }
        .toast.error { background: var(--danger); }
        .toast.warning { background: var(--warning); }

        @keyframes slideIn {
            from {
                transform: translateX(100%);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }

        /* Empty State */
        .empty-state {
            text-align: center;
            padding: 60px 20px;
            color: var(--text-light);
        }

        .empty-state .material-icons {
            font-size: 64px;
            margin-bottom: 16px;
            opacity: 0.5;
        }

        .empty-state h3 {
            margin-bottom: 8px;
            color: var(--text);
        }

        /* Search */
        .search-box {
            display: flex;
            align-items: center;
            gap: 8px;
            background: var(--background);
            border: 1px solid var(--border);
            border-radius: 8px;
            padding: 8px 16px;
        }

        .search-box input {
            border: none;
            background: none;
            outline: none;
            font-size: 14px;
            width: 200px;
        }

        .search-box .material-icons {
            color: var(--text-light);
            font-size: 20px;
        }

        /* Report Modal */
        .report-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 16px;
            margin-bottom: 24px;
        }

        .report-stat {
            background: var(--background);
            padding: 16px;
            border-radius: 8px;
            text-align: center;
        }

        .report-stat-value {
            font-size: 24px;
            font-weight: 700;
            color: var(--primary);
        }

        .report-stat-label {
            font-size: 12px;
            color: var(--text-light);
            margin-top: 4px;
        }

        .chart-container {
            height: 300px;
            margin-top: 20px;
        }

        /* Course Details Modal */
        .course-detail-section {
            margin-bottom: 16px;
        }

        .course-detail-label {
            font-size: 12px;
            color: var(--text-light);
            text-transform: uppercase;
            margin-bottom: 4px;
        }

        .course-detail-value {
            font-size: 16px;
            font-weight: 500;
        }

        .course-detail-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 16px;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .sidebar {
                transform: translateX(-100%);
                z-index: 100;
            }

            .sidebar.mobile-open {
                transform: translateX(0);
            }

            .main-content {
                margin-left: 0;
            }

            .form-row {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <!-- Login Page -->
    <div class="login-page" id="loginPage">
        <div class="login-card">
            <div class="login-header">
                <h1>CSF Manager</h1>
                <p>Sistema de Gestão de Cursos</p>
            </div>
            <form id="loginForm">
                <div class="form-group">
                    <label class="form-label">Usuário</label>
                    <input type="text" class="form-input" id="loginUsername" required>
                </div>
                <div class="form-group">
                    <label class="form-label">Senha</label>
                    <input type="password" class="form-input" id="loginPassword" required>
                </div>
                <div class="form-error" id="loginError">Usuário ou senha inválidos</div>
                <button type="submit" class="btn btn-primary btn-full">
                    <span class="material-icons">login</span>
                    Entrar
                </button>
            </form>
        </div>
    </div>

    <!-- Dashboard -->
    <div class="dashboard" id="dashboard">
        <nav class="sidebar" id="sidebar">
            <div class="sidebar-header">
                <h2>CSF Manager</h2>
                <p id="userInfo">Carregando...</p>
            </div>
            <ul class="nav-menu">
                <li class="nav-item active" data-page="dashboard">
                    <span class="material-icons">dashboard</span>
                    Painel Principal
                </li>
                <li class="nav-item" data-page="courses">
                    <span class="material-icons">school</span>
                    Adicionar Cursos
                </li>
                <li class="nav-item" data-page="instructors">
                    <span class="material-icons">people</span>
                    Instrutores
                </li>
                <li class="nav-item" data-page="calendar">
                    <span class="material-icons">calendar_today</span>
                    Calendário
                </li>
                <div class="nav-divider"></div>
                <li class="nav-item admin-only" data-page="settings">
                    <span class="material-icons">settings</span>
                    Configurações
                </li>
                <li class="nav-item admin-only" data-page="users">
                    <span class="material-icons">manage_accounts</span>
                    Gerenciador de Usuários
                </li>
                <div class="nav-divider"></div>
                <li class="nav-item" id="logoutBtn">
                    <span class="material-icons">logout</span>
                    Sair
                </li>
            </ul>
        </nav>

        <main class="main-content">
            <!-- Dashboard Page -->
            <section class="page active" id="dashboardPage">
                <div class="page-header">
                    <h1 class="page-title">Painel Principal</h1>
                    <div class="page-actions">
                        <div class="search-box">
                            <span class="material-icons">search</span>
                            <input type="text" placeholder="Buscar cursos..." id="searchCourses">
                        </div>
                        <button class="btn btn-secondary" id="reportBtn">
                            <span class="material-icons">assessment</span>
                            Relatório
                        </button>
                    </div>
                </div>
                <div class="stats-grid" id="statsGrid"></div>
                <div class="card">
                    <div class="card-header">Cursos Cadastrados</div>
                    <div class="card-body">
                        <div class="course-grid" id="courseGrid"></div>
                    </div>
                </div>
            </section>

            <!-- Courses Page -->
            <section class="page" id="coursesPage">
                <div class="page-header">
                    <h1 class="page-title">Adicionar Cursos</h1>
                    <button class="btn btn-primary" id="newCourseBtn">
                        <span class="material-icons">add</span>
                        Novo Curso
                    </button>
                </div>
                <div class="card">
                    <div class="card-body">
                        <div class="course-grid" id="courseGridFull"></div>
                    </div>
                </div>
            </section>

            <!-- Instructors Page -->
            <section class="page" id="instructorsPage">
                <div class="page-header">
                    <h1 class="page-title">Instrutores</h1>
                    <button class="btn btn-primary" id="newInstructorBtn">
                        <span class="material-icons">person_add</span>
                        Novo Instrutor
                    </button>
                </div>
                <div class="instructor-grid" id="instructorGrid"></div>
            </section>

            <!-- Calendar Page -->
            <section class="page" id="calendarPage">
                <div class="page-header">
                    <h1 class="page-title">Calendário</h1>
                </div>
                <div class="card">
                    <div class="card-body">
                        <div class="calendar-header">
                            <h3 id="calendarTitle">Dezembro 2024</h3>
                            <div class="calendar-nav">
                                <button class="btn btn-secondary btn-icon" id="prevMonth">
                                    <span class="material-icons">chevron_left</span>
                                </button>
                                <button class="btn btn-secondary" id="todayBtn">Hoje</button>
                                <button class="btn btn-secondary btn-icon" id="nextMonth">
                                    <span class="material-icons">chevron_right</span>
                                </button>
                            </div>
                        </div>
                        <div class="calendar-grid" id="calendarGrid"></div>
                    </div>
                </div>
            </section>

            <!-- Settings Page -->
            <section class="page" id="settingsPage">
                <div class="page-header">
                    <h1 class="page-title">Configurações</h1>
                </div>
                <div class="card">
                    <div class="card-body">
                        <!-- Seção de alterar senha -->
                        <div class="settings-section">
                            <h3>Alterar Senha</h3>
                            <form id="changePasswordForm">
                                <div class="form-group">
                                    <label class="form-label">Senha Atual</label>
                                    <input type="password" class="form-input" id="currentPassword" required>
                                </div>
                                <div class="form-group">
                                    <label class="form-label">Nova Senha</label>
                                    <input type="password" class="form-input" id="newPassword" required>
                                </div>
                                <div class="form-group">
                                    <label class="form-label">Confirmar Nova Senha</label>
                                    <input type="password" class="form-input" id="confirmPassword" required>
                                </div>
                                <button type="submit" class="btn btn-primary">
                                    <span class="material-icons">lock</span>
                                    Alterar Senha
                                </button>
                            </form>
                        </div>

                        <div class="settings-section">
                            <h3>Importação de Dados</h3>
                            <div class="settings-row">
                                <div class="settings-info">
                                    <h4>Importar Planilha Excel</h4>
                                    <p>Importe cursos de um arquivo .xlsx ou .csv</p>
                                </div>
                                <label class="btn btn-secondary">
                                    <span class="material-icons">upload_file</span>
                                    Selecionar Arquivo
                                    <input type="file" accept=".xlsx,.csv" id="excelFileInput" style="display: none;">
                                </label>
                            </div>
                        </div>

                        <div class="settings-section">
                            <h3>Exportação de Dados</h3>
                            <div class="settings-row">
                                <div class="settings-info">
                                    <h4>Exportar Cursos</h4>
                                    <p>Baixe todos os cursos em formato CSV</p>
                                </div>
                                <button class="btn btn-secondary" id="exportCoursesBtn">
                                    <span class="material-icons">download</span>
                                    Exportar CSV
                                </button>
                            </div>
                            <div class="settings-row">
                                <div class="settings-info">
                                    <h4>Exportar Instrutores</h4>
                                    <p>Baixe todos os instrutores em formato CSV</p>
                                </div>
                                <button class="btn btn-secondary" id="exportInstructorsBtn">
                                    <span class="material-icons">download</span>
                                    Exportar CSV
                                </button>
                            </div>
                        </div>

                        <div class="settings-section">
                            <h3>Zona de Perigo</h3>
                            <div class="settings-row">
                                <div class="settings-info">
                                    <h4>Limpar Todos os Dados</h4>
                                    <p>Remove todos os cursos e instrutores permanentemente</p>
                                </div>
                                <button class="btn btn-danger" id="clearDataBtn">
                                    <span class="material-icons">delete_forever</span>
                                    Limpar Dados
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Users Management Page -->
            <section class="page" id="usersPage">
                <div class="page-header">
                    <h1 class="page-title">Gerenciador de Usuários</h1>
                    <button class="btn btn-primary" onclick="openUserModal()">
                        <span class="material-icons">person_add</span>
                        Novo Usuário
                    </button>
                </div>
                <div class="card" style="margin-bottom: 24px;">
                    <div class="card-header">Usuários do Sistema</div>
                    <div class="card-body">
                        <table class="users-table">
                            <thead>
                                <tr>
                                    <th>Usuário</th>
                                    <th>Permissão</th>
                                    <th>Ações</th>
                                </tr>
                            </thead>
                            <tbody id="usersTableBody"></tbody>
                        </table>
                    </div>
                </div>

                <!-- Relatório de atividades dos usuários -->
                <div class="card">
                    <div class="card-header">Relatório de Atividades</div>
                    <div class="card-body">
                        <div class="activity-log" id="activityLog"></div>
                    </div>
                </div>
            </section>
        </main>
    </div>

    <!-- Course Modal -->
    <div class="modal-overlay" id="courseModal">
        <div class="modal">
            <div class="modal-header">
                <h3 id="courseModalTitle">Novo Curso</h3>
                <button class="modal-close" onclick="closeModal('courseModal')">
                    <span class="material-icons">close</span>
                </button>
            </div>
            <form id="courseForm">
                <div class="modal-body">
                    <div class="form-group">
                        <label class="form-label">Nome do Curso *</label>
                        <input type="text" class="form-input" id="courseName" required>
                        <div class="form-error" id="courseNameError">Nome do curso é obrigatório</div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label class="form-label">ID da Turma</label>
                            <input type="number" class="form-input" id="courseIdLote" placeholder="Ex: 001">
                        </div>
                        <div class="form-group">
                            <label class="form-label">LOTE - RESPONSÁVEL</label>
                            <input type="text" class="form-input" id="courseLoteResponsavel" placeholder="Ex: Lote 01 - João Silva">
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label class="form-label">Cidade/Município *</label>
                            <input type="text" class="form-input" id="courseCity" required>
                            <div class="form-error" id="courseCityError">Cidade é obrigatória</div>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Local do Curso</label>
                            <input type="text" class="form-input" id="courseLocation" placeholder="Ex: Centro de Treinamento">
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label class="form-label">Data Início *</label>
                            <input type="date" class="form-input" id="courseStart" required>
                            <div class="form-error" id="courseStartError">Data de início é obrigatória</div>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Data Fim *</label>
                            <input type="date" class="form-input" id="courseEnd" required>
                            <div class="form-error" id="courseEndError">Data de fim é obrigatória</div>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label class="form-label">Status</label>
                            <select class="form-select" id="courseStatus">
                                <option value="Pendente">Pendente</option>
                                <option value="Em Andamento">Em Andamento</option>
                                <option value="Concluído">Concluído</option>
                                <option value="Cancelado">Cancelado</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Concludentes</label>
                            <input type="number" class="form-input" id="courseStudents" min="0" value="0">
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Instrutor</label>
                        <div style="display: flex; gap: 8px;">
                            <select class="form-select" id="courseInstructor" style="flex: 1;">
                                <option value="">Selecione um instrutor</option>
                            </select>
                            <button type="button" class="btn btn-secondary btn-icon" onclick="openQuickInstructorModal()" title="Adicionar instrutor">
                                <span class="material-icons">person_add</span>
                            </button>
                        </div>
                    </div>
                    <!-- Campo para link do Google Drive -->
                    <div class="form-group">
                        <label class="form-label">Link do Google Drive</label>
                        <input type="url" class="form-input" id="courseDriveLink" placeholder="https://drive.google.com/...">
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" onclick="closeModal('courseModal')">Cancelar</button>
                    <button type="submit" class="btn btn-primary">
                        <span class="material-icons">save</span>
                        Salvar
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Instructor Modal -->
    <div class="modal-overlay" id="instructorModal">
        <div class="modal">
            <div class="modal-header">
                <h3 id="instructorModalTitle">Novo Instrutor</h3>
                <button class="modal-close" onclick="closeModal('instructorModal')">
                    <span class="material-icons">close</span>
                </button>
            </div>
            <form id="instructorForm">
                <div class="modal-body">
                    <div class="form-group">
                        <label class="form-label">Nome Completo *</label>
                        <input type="text" class="form-input" id="instructorName" required>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Especialidade</label>
                        <input type="text" class="form-input" id="instructorSpecialty" placeholder="Ex: Segurança do Trabalho">
                    </div>
                    <div class="form-group">
                        <label class="form-label">Telefone (WhatsApp)</label>
                        <input type="tel" class="form-input" id="instructorPhone" placeholder="(00) 00000-0000">
                    </div>
                    <div class="form-group">
                        <label class="form-label">Email</label>
                        <input type="email" class="form-input" id="instructorEmail" placeholder="email@exemplo.com">
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" onclick="closeModal('instructorModal')">Cancelar</button>
                    <button type="submit" class="btn btn-primary">
                        <span class="material-icons">save</span>
                        Salvar
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Quick Instructor Modal -->
    <div class="modal-overlay" id="quickInstructorModal">
        <div class="modal" style="max-width: 400px;">
            <div class="modal-header">
                <h3>Adicionar Instrutor Rápido</h3>
                <button class="modal-close" onclick="closeModal('quickInstructorModal')">
                    <span class="material-icons">close</span>
                </button>
            </div>
            <form id="quickInstructorForm">
                <div class="modal-body">
                    <div class="form-group">
                        <label class="form-label">Nome do Instrutor *</label>
                        <input type="text" class="form-input" id="quickInstructorName" required>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Telefone (WhatsApp)</label>
                        <input type="tel" class="form-input" id="quickInstructorPhone" placeholder="(00) 00000-0000">
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" onclick="closeModal('quickInstructorModal')">Cancelar</button>
                    <button type="submit" class="btn btn-primary">
                        <span class="material-icons">add</span>
                        Adicionar
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- User Modal -->
    <div class="modal-overlay" id="userModal">
        <div class="modal" style="max-width: 450px;">
            <div class="modal-header">
                <h3 id="userModalTitle">Novo Usuário</h3>
                <button class="modal-close" onclick="closeModal('userModal')">
                    <span class="material-icons">close</span>
                </button>
            </div>
            <form id="userForm">
                <div class="modal-body">
                    <div class="form-group">
                        <label class="form-label">Nome de Usuário *</label>
                        <input type="text" class="form-input" id="userUsername" required>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Senha *</label>
                        <input type="password" class="form-input" id="userPassword" required>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Permissão</label>
                        <select class="form-select" id="userRole">
                            <option value="viewer">Visualizador - Apenas visualiza</option>
                            <option value="editor">Editor - Pode adicionar e editar</option>
                            <option value="admin">Administrador - Acesso total</option>
                        </select>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" onclick="closeModal('userModal')">Cancelar</button>
                    <button type="submit" class="btn btn-primary">
                        <span class="material-icons">save</span>
                        Salvar
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Report Modal -->
    <div class="modal-overlay" id="reportModal">
        <div class="modal" style="max-width: 700px;">
            <div class="modal-header">
                <h3>Relatório Geral</h3>
                <button class="modal-close" onclick="closeModal('reportModal')">
                    <span class="material-icons">close</span>
                </button>
            </div>
            <div class="modal-body" id="reportContent">
                <div class="report-stats" id="reportStats"></div>
                <div class="chart-container">
                    <canvas id="reportChart"></canvas>
                </div>
            </div>
            <div class="modal-footer">
                <!-- Alterado de Exportar CSV para Baixar Imagem -->
                <button class="btn btn-primary" onclick="downloadReportImage()">
                    <span class="material-icons">image</span>
                    Baixar Imagem
                </button>
            </div>
        </div>
    </div>

    <!-- Course Details Modal -->
    <div class="modal-overlay" id="courseDetailsModal">
        <div class="modal" style="max-width: 550px;">
            <div class="modal-header">
                <h3 id="courseDetailsTitle">Detalhes do Curso</h3>
                <button class="modal-close" onclick="closeModal('courseDetailsModal')">
                    <span class="material-icons">close</span>
                </button>
            </div>
            <div class="modal-body" id="courseDetailsContent"></div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeModal('courseDetailsModal')">Fechar</button>
            </div>
        </div>
    </div>

    <!-- Toast Container -->
    <div class="toast-container" id="toastContainer"></div>

    <script>
        // Firebase Configuration
        const firebaseConfig = {
            apiKey: "AIzaSyDemo123456789",
            authDomain: "csf-manager.firebaseapp.com",
            projectId: "csf-manager",
            storageBucket: "csf-manager.appspot.com",
            messagingSenderId: "123456789",
            appId: "1:123456789:web:abc123def456"
        };

        // Initialize Firebase (with fallback to localStorage)
        let db;
        let useLocalStorage = true;

        try {
            firebase.initializeApp(firebaseConfig);
            db = firebase.firestore();
        } catch (e) {
            console.log('Using localStorage fallback');
            useLocalStorage = true;
        }

        // Local Storage DB Simulation
        const localDB = {
            collections: {},
            collection(name) {
                if (!this.collections[name]) {
                    const stored = localStorage.getItem(`csf_${name}`);
                    this.collections[name] = stored ? JSON.parse(stored) : [];
                }
                return {
                    data: this.collections[name],
                    save: () => localStorage.setItem(`csf_${name}`, JSON.stringify(this.collections[name])),
                    async add(doc) {
                        const id = Date.now().toString();
                        localDB.collections[name].push({ id, ...doc });
                        this.save();
                        return { id };
                    },
                    doc(id) {
                        return {
                            async update(data) {
                                const idx = localDB.collections[name].findIndex(d => d.id === id);
                                if (idx !== -1) {
                                    localDB.collections[name][idx] = { ...localDB.collections[name][idx], ...data };
                                    localStorage.setItem(`csf_${name}`, JSON.stringify(localDB.collections[name]));
                                }
                            },
                            async delete() {
                                localDB.collections[name] = localDB.collections[name].filter(d => d.id !== id);
                                localStorage.setItem(`csf_${name}`, JSON.stringify(localDB.collections[name]));
                            }
                        };
                    },
                    onSnapshot(callback) {
                        callback({
                            docs: this.data.map(d => ({
                                id: d.id,
                                data: () => d
                            }))
                        });
                        return () => {};
                    }
                };
            }
        };

        if (useLocalStorage) {
            db = localDB;
        }

        // App State
        let currentUser = null;
        let cursos = [];
        let instrutores = [];
        let activities = [];
        let users = [];
        let currentMonth = new Date().getMonth();
        let currentYear = new Date().getFullYear();
        let editingCourseId = null;
        let editingInstructorId = null;
        let editingUserId = null;
        let reportChart = null;

        const defaultUsers = [
            { id: 'admin1', username: 'Csfiac', password: '032147', role: 'admin' },
            { id: 'viewer1', username: 'Iac', password: 'Iac@123', role: 'viewer' }
        ];

        // Initialize
        document.addEventListener('DOMContentLoaded', () => {
            loadUsers();
            loadActivities();
            setupEventListeners();
        });

        function loadUsers() {
            const stored = localStorage.getItem('csf_users');
            if (stored) {
                users = JSON.parse(stored);
            } else {
                users = [...defaultUsers];
                saveUsers();
            }
        }

        function saveUsers() {
            localStorage.setItem('csf_users', JSON.stringify(users));
        }

        function loadActivities() {
            const stored = localStorage.getItem('csf_activities');
            activities = stored ? JSON.parse(stored) : [];
        }

        function saveActivities() {
            localStorage.setItem('csf_activities', JSON.stringify(activities));
        }

        function logActivity(action, description, type = 'info') {
            const activity = {
                id: Date.now().toString(),
                user: currentUser?.username || 'Sistema',
                action,
                description,
                type,
                timestamp: new Date().toISOString()
            };
            activities.unshift(activity);
            if (activities.length > 100) activities = activities.slice(0, 100);
            saveActivities();
            renderActivityLog();
        }

        function setupEventListeners() {
            // Login
            document.getElementById('loginForm').addEventListener('submit', handleLogin);
            document.getElementById('logoutBtn').addEventListener('click', handleLogout);

            // Navigation
            document.querySelectorAll('.nav-item[data-page]').forEach(item => {
                item.addEventListener('click', () => navigateTo(item.dataset.page));
            });

            // Search
            document.getElementById('searchCourses').addEventListener('input', renderCourses);

            // Report
            document.getElementById('reportBtn').addEventListener('click', openReportModal);

            // Buttons
            document.getElementById('newCourseBtn').addEventListener('click', () => openCourseModal());
            document.getElementById('newInstructorBtn').addEventListener('click', () => openInstructorModal());

            // Calendar
            document.getElementById('prevMonth').addEventListener('click', () => changeMonth(-1));
            document.getElementById('nextMonth').addEventListener('click', () => changeMonth(1));
            document.getElementById('todayBtn').addEventListener('click', goToToday);

            // Forms
            document.getElementById('courseForm').addEventListener('submit', handleCourseSubmit);
            document.getElementById('instructorForm').addEventListener('submit', handleInstructorSubmit);
            document.getElementById('quickInstructorForm').addEventListener('submit', handleQuickInstructorSubmit);
            document.getElementById('userForm').addEventListener('submit', handleUserSubmit);
            document.getElementById('changePasswordForm').addEventListener('submit', handleChangePassword);

            // Settings
            document.getElementById('excelFileInput').addEventListener('change', handleExcelUpload);
            document.getElementById('exportCoursesBtn').addEventListener('click', exportCoursesToCsv);
            document.getElementById('exportInstructorsBtn').addEventListener('click', exportInstructorsToCsv);
            document.getElementById('clearDataBtn').addEventListener('click', clearAllData);
        }

        // Authentication
        function handleLogin(e) {
            e.preventDefault();
            const username = document.getElementById('loginUsername').value.trim();
            const password = document.getElementById('loginPassword').value;

            const user = users.find(u => u.username === username && u.password === password);

            if (user) {
                currentUser = user;
                document.getElementById('loginPage').style.display = 'none';
                document.getElementById('dashboard').classList.add('active');
                document.getElementById('userInfo').textContent = `${user.username} (${getRoleName(user.role)})`;

                // Show/hide admin elements
                document.querySelectorAll('.admin-only').forEach(el => {
                    el.style.display = user.role === 'admin' ? 'flex' : 'none';
                });

                logActivity('Login', `Usuário ${username} entrou no sistema`, 'login');
                initializeData();
            } else {
                document.getElementById('loginError').classList.add('show');
                setTimeout(() => document.getElementById('loginError').classList.remove('show'), 3000);
            }
        }

        function handleLogout() {
            logActivity('Logout', `Usuário ${currentUser?.username} saiu do sistema`, 'login');
            currentUser = null;
            document.getElementById('dashboard').classList.remove('active');
            document.getElementById('loginPage').style.display = 'flex';
            document.getElementById('loginForm').reset();
        }

        function getRoleName(role) {
            const names = { admin: 'Administrador', editor: 'Editor', viewer: 'Visualizador' };
            return names[role] || role;
        }

        function handleChangePassword(e) {
            e.preventDefault();
            const currentPassword = document.getElementById('currentPassword').value;
            const newPassword = document.getElementById('newPassword').value;
            const confirmPassword = document.getElementById('confirmPassword').value;

            if (currentUser.password !== currentPassword) {
                showToast('Senha atual incorreta', 'error');
                return;
            }

            if (newPassword !== confirmPassword) {
                showToast('As senhas não coincidem', 'error');
                return;
            }

            if (newPassword.length < 4) {
                showToast('A nova senha deve ter pelo menos 4 caracteres', 'error');
                return;
            }

            const userIndex = users.findIndex(u => u.id === currentUser.id);
            if (userIndex !== -1) {
                users[userIndex].password = newPassword;
                currentUser.password = newPassword;
                saveUsers();
                logActivity('Alteração de Senha', 'Alterou sua própria senha', 'edit');
                showToast('Senha alterada com sucesso!', 'success');
                document.getElementById('changePasswordForm').reset();
            }
        }

        // Initialize Data
        function initializeData() {
            // Load courses
            db.collection('cursos').onSnapshot(snapshot => {
                cursos = snapshot.docs.map(doc => ({ id: doc.id, ...doc.data() }));
                renderCourses();
                renderStats();
                renderCalendar();
            });

            // Load instructors
            db.collection('instrutores').onSnapshot(snapshot => {
                instrutores = snapshot.docs.map(doc => ({ id: doc.id, ...doc.data() }));
                renderInstructors();
                updateInstructorSelect();
            });

            renderUsersTable();
            renderActivityLog();
        }

        // Navigation
        function navigateTo(page) {
            document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
            document.querySelectorAll('.nav-item').forEach(n => n.classList.remove('active'));

            document.getElementById(`${page}Page`).classList.add('active');
            document.querySelector(`.nav-item[data-page="${page}"]`)?.classList.add('active');

            if (page === 'calendar') renderCalendar();
            if (page === 'users') {
                renderUsersTable();
                renderActivityLog();
            }
        }

        // Stats
        function renderStats() {
            const total = cursos.length;
            const concluidos = cursos.filter(c => c.status === 'Concluído').length;
            const andamento = cursos.filter(c => c.status === 'Em Andamento').length;
            const pendentes = cursos.filter(c => c.status === 'Pendente').length;

            document.getElementById('statsGrid').innerHTML = `
                <div class="stat-card">
                    <div class="stat-icon blue">
                        <span class="material-icons">school</span>
                    </div>
                    <div class="stat-value">${total}</div>
                    <div class="stat-label">Total de Cursos</div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon green">
                        <span class="material-icons">check_circle</span>
                    </div>
                    <div class="stat-value">${concluidos}</div>
                    <div class="stat-label">Concluídos</div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon yellow">
                        <span class="material-icons">pending</span>
                    </div>
                    <div class="stat-value">${andamento}</div>
                    <div class="stat-label">Em Andamento</div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon red">
                        <span class="material-icons">schedule</span>
                    </div>
                    <div class="stat-value">${pendentes}</div>
                    <div class="stat-label">Pendentes</div>
                </div>
            `;
        }

        // Courses
        function renderCourses() {
            const searchTerm = document.getElementById('searchCourses').value.toLowerCase();
            const filtered = cursos.filter(c =>
                (c.curso || '').toLowerCase().includes(searchTerm) ||
                (c.cidade || '').toLowerCase().includes(searchTerm) ||
                (c.instrutor || '').toLowerCase().includes(searchTerm)
            );

            const grid = document.getElementById('courseGrid');
            const gridFull = document.getElementById('courseGridFull');

            if (filtered.length === 0) {
                const emptyHtml = `
                    <div class="empty-state" style="grid-column: 1 / -1;">
                        <span class="material-icons">school</span>
                        <h3>Nenhum curso encontrado</h3>
                        <p>Adicione seu primeiro curso</p>
                    </div>
                `;
                grid.innerHTML = emptyHtml;
                gridFull.innerHTML = emptyHtml;
                return;
            }

            const coursesHtml = filtered.map(course => {
                const statusClass = getStatusClass(course.status);
                const canEdit = currentUser?.role !== 'viewer';

                return `
                    <div class="course-card" onclick="openCourseDetails('${course.id}')">
                        <div class="course-header">
                            <div>
                                <div class="course-title">${course.curso || 'Sem nome'}</div>
                                <div class="course-id">ID da Turma: ${course.idLote || 'N/A'}${course.loteResponsavel ? ' | ' + course.loteResponsavel : ''}</div>
                            </div>
                            <div class="course-actions" onclick="event.stopPropagation()">
                                ${course.driveLink ? `
                                    <button class="drive" onclick="window.open('${course.driveLink}', '_blank')" title="Abrir Google Drive">
                                        <span class="material-icons">folder</span>
                                    </button>
                                ` : ''}
                                ${canEdit ? `
                                    <button onclick="openCourseModal('${course.id}')" title="Editar">
                                        <span class="material-icons">edit</span>
                                    </button>
                                    <button class="delete" onclick="deleteCourse('${course.id}')" title="Excluir">
                                        <span class="material-icons">delete</span>
                                    </button>
                                ` : ''}
                            </div>
                        </div>
                        <div class="course-info">
                            <div class="course-info-item">
                                <span class="material-icons">location_on</span>
                                ${course.cidade || 'Local não definido'}${course.local ? ' - ' + course.local : ''}
                            </div>
                            <div class="course-info-item">
                                <span class="material-icons">event</span>
                                ${formatDate(course.inicio)} - ${formatDate(course.fim)}
                            </div>
                            <div class="course-info-item">
                                <span class="material-icons">person</span>
                                ${course.instrutor || 'Instrutor não definido'}
                            </div>
                            <div class="course-info-item">
                                <span class="material-icons">groups</span>
                                ${course.alunos || 0} concludentes
                            </div>
                            <div>
                                <span class="status-badge ${statusClass}">${course.status || 'Pendente'}</span>
                            </div>
                        </div>
                    </div>
                `;
            }).join('');

            grid.innerHTML = coursesHtml;
            gridFull.innerHTML = coursesHtml;
        }

        function openCourseDetails(courseId) {
            const course = cursos.find(c => c.id === courseId);
            if (!course) return;

            document.getElementById('courseDetailsTitle').textContent = course.curso || 'Detalhes do Curso';
            
            const content = document.getElementById('courseDetailsContent');
            content.innerHTML = `
                <div class="course-detail-grid">
                    <div class="course-detail-section">
                        <div class="course-detail-label">ID da Turma</div>
                        <div class="course-detail-value">${course.idLote || 'N/A'}</div>
                    </div>
                    <div class="course-detail-section">
                        <div class="course-detail-label">Lote - Responsável</div>
                        <div class="course-detail-value">${course.loteResponsavel || 'N/A'}</div>
                    </div>
                </div>
                <div class="course-detail-section">
                    <div class="course-detail-label">Cidade/Município</div>
                    <div class="course-detail-value">${course.cidade || 'N/A'}</div>
                </div>
                <div class="course-detail-section">
                    <div class="course-detail-label">Local do Curso</div>
                    <div class="course-detail-value">${course.local || 'N/A'}</div>
                </div>
                <div class="course-detail-grid">
                    <div class="course-detail-section">
                        <div class="course-detail-label">Data de Início</div>
                        <div class="course-detail-value">${formatDate(course.inicio)}</div>
                    </div>
                    <div class="course-detail-section">
                        <div class="course-detail-label">Data de Término</div>
                        <div class="course-detail-value">${formatDate(course.fim)}</div>
                    </div>
                </div>
                <div class="course-detail-grid">
                    <div class="course-detail-section">
                        <div class="course-detail-label">Status</div>
                        <div class="course-detail-value">
                            <span class="status-badge ${getStatusClass(course.status)}">${course.status || 'Pendente'}</span>
                        </div>
                    </div>
                    <div class="course-detail-section">
                        <div class="course-detail-label">Concludentes</div>
                        <div class="course-detail-value">${course.alunos || 0} alunos</div>
                    </div>
                </div>
                <div class="course-detail-section">
                    <div class="course-detail-label">Instrutor</div>
                    <div class="course-detail-value">${course.instrutor || 'Não definido'}</div>
                </div>
                ${course.driveLink ? `
                    <div class="course-detail-section">
                        <div class="course-detail-label">Google Drive</div>
                        <div class="course-detail-value">
                            <a href="${course.driveLink}" target="_blank" style="color: var(--primary); display: flex; align-items: center; gap: 4px;">
                                <span class="material-icons" style="font-size: 18px;">folder</span>
                                Abrir pasta
                            </a>
                        </div>
                    </div>
                ` : ''}
            `;

            document.getElementById('courseDetailsModal').classList.add('active');
        }

        function getStatusClass(status) {
            const classes = {
                'Concluído': 'concluido',
                'Em Andamento': 'andamento',
                'Pendente': 'pendente',
                'Cancelado': 'cancelado'
            };
            return classes[status] || 'pendente';
        }

        function formatDate(dateStr) {
            if (!dateStr) return 'N/A';
            const date = new Date(dateStr + 'T00:00:00');
            return date.toLocaleDateString('pt-BR');
        }

        // Instructors
        function renderInstructors() {
            const grid = document.getElementById('instructorGrid');

            if (instrutores.length === 0) {
                grid.innerHTML = `
                    <div class="empty-state" style="grid-column: 1 / -1;">
                        <span class="material-icons">people</span>
                        <h3>Nenhum instrutor cadastrado</h3>
                        <p>Adicione seu primeiro instrutor</p>
                    </div>
                `;
                return;
            }

            grid.innerHTML = instrutores.map(instructor => {
                const coursesCount = cursos.filter(c => c.instrutor === instructor.nome).length;
                const canEdit = currentUser?.role !== 'viewer';
                const phoneForWhatsapp = instructor.telefone ? instructor.telefone.replace(/\D/g, '') : '';

                return `
                    <div class="instructor-card">
                        <div class="instructor-avatar">${instructor.nome?.charAt(0) || '?'}</div>
                        <div class="instructor-name">${instructor.nome || 'Sem nome'}</div>
                        <div class="instructor-specialty">${instructor.especialidade || 'Sem especialidade'}</div>
                        <div class="instructor-contact">
                            ${phoneForWhatsapp ? `
                                <button class="instructor-contact-btn whatsapp" onclick="window.open('https://wa.me/55${phoneForWhatsapp}', '_blank')" title="WhatsApp">
                                    <span class="material-icons">message</span>
                                </button>
                            ` : ''}
                            ${instructor.email ? `
                                <button class="instructor-contact-btn" onclick="window.open('mailto:${instructor.email}', '_blank')" title="Email">
                                    <span class="material-icons">email</span>
                                </button>
                            ` : ''}
                        </div>
                        <div class="instructor-stats">
                            <div class="instructor-stat">
                                <div class="instructor-stat-value">${coursesCount}</div>
                                <div class="instructor-stat-label">Cursos</div>
                            </div>
                        </div>
                        ${canEdit ? `
                            <div class="instructor-actions">
                                <button class="btn btn-secondary btn-icon" onclick="openInstructorModal('${instructor.id}')" title="Editar">
                                    <span class="material-icons">edit</span>
                                </button>
                                <button class="btn btn-danger btn-icon" onclick="deleteInstructor('${instructor.id}')" title="Excluir">
                                    <span class="material-icons">delete</span>
                                </button>
                            </div>
                        ` : ''}
                    </div>
                `;
            }).join('');
        }

        function updateInstructorSelect() {
            const select = document.getElementById('courseInstructor');
            const currentValue = select.value;
            
            select.innerHTML = '<option value="">Selecione um instrutor</option>';
            instrutores.forEach(inst => {
                select.innerHTML += `<option value="${inst.nome}">${inst.nome}</option>`;
            });
            
            if (currentValue) select.value = currentValue;
        }

        // Calendar
        function renderCalendar() {
            const grid = document.getElementById('calendarGrid');
            const title = document.getElementById('calendarTitle');
            
            const months = ['Janeiro', 'Fevereiro', 'Março', 'Abril', 'Maio', 'Junho', 'Julho', 'Agosto', 'Setembro', 'Outubro', 'Novembro', 'Dezembro'];
            title.textContent = `${months[currentMonth]} ${currentYear}`;

            const firstDay = new Date(currentYear, currentMonth, 1);
            const lastDay = new Date(currentYear, currentMonth + 1, 0);
            const startDay = firstDay.getDay();
            const daysInMonth = lastDay.getDate();

            const today = new Date();
            
            let html = ['Dom', 'Seg', 'Ter', 'Qua', 'Qui', 'Sex', 'Sáb'].map(d => 
                `<div class="calendar-day-header">${d}</div>`
            ).join('');

            // Previous month days
            const prevMonthDays = new Date(currentYear, currentMonth, 0).getDate();
            for (let i = startDay - 1; i >= 0; i--) {
                html += `<div class="calendar-day other-month">${prevMonthDays - i}</div>`;
            }

            // Current month days
            for (let day = 1; day <= daysInMonth; day++) {
                const dateStr = `${currentYear}-${String(currentMonth + 1).padStart(2, '0')}-${String(day).padStart(2, '0')}`;
                const hasEvent = cursos.some(c => c.inicio === dateStr || c.fim === dateStr);
                const isToday = day === today.getDate() && currentMonth === today.getMonth() && currentYear === today.getFullYear();
                
                html += `<div class="calendar-day${isToday ? ' today' : ''}${hasEvent ? ' has-event' : ''}">${day}</div>`;
            }

            // Next month days
            const remaining = 42 - (startDay + daysInMonth);
            for (let i = 1; i <= remaining; i++) {
                html += `<div class="calendar-day other-month">${i}</div>`;
            }

            grid.innerHTML = html;
        }

        function changeMonth(delta) {
            currentMonth += delta;
            if (currentMonth > 11) {
                currentMonth = 0;
                currentYear++;
            } else if (currentMonth < 0) {
                currentMonth = 11;
                currentYear--;
            }
            renderCalendar();
        }

        function goToToday() {
            const today = new Date();
            currentMonth = today.getMonth();
            currentYear = today.getFullYear();
            renderCalendar();
        }

        // Users Table
        function renderUsersTable() {
            const tbody = document.getElementById('usersTableBody');
            tbody.innerHTML = users.map(user => `
                <tr>
                    <td><strong>${user.username}</strong></td>
                    <td><span class="role-badge ${user.role}">${getRoleName(user.role)}</span></td>
                    <td>
                        <button class="btn btn-secondary btn-icon" onclick="openUserModal('${user.id}')" title="Editar">
                            <span class="material-icons">edit</span>
                        </button>
                        ${user.id !== 'admin1' ? `
                            <button class="btn btn-danger btn-icon" onclick="deleteUser('${user.id}')" title="Excluir">
                                <span class="material-icons">delete</span>
                            </button>
                        ` : ''}
                    </td>
                </tr>
            `).join('');
        }

        // Activity Log
        function renderActivityLog() {
            const log = document.getElementById('activityLog');
            if (!log) return;

            if (activities.length === 0) {
                log.innerHTML = `
                    <div class="empty-state">
                        <span class="material-icons">history</span>
                        <h3>Nenhuma atividade registrada</h3>
                    </div>
                `;
                return;
            }

            log.innerHTML = activities.map(activity => {
                const iconType = activity.type || 'info';
                const icons = { add: 'add_circle', edit: 'edit', delete: 'delete', login: 'login', info: 'info' };
                
                return `
                    <div class="activity-item">
                        <div class="activity-icon ${iconType}">
                            <span class="material-icons">${icons[iconType] || 'info'}</span>
                        </div>
                        <div class="activity-content">
                            <div class="activity-title">${activity.action}</div>
                            <div class="activity-user">${activity.user}</div>
                            <div class="activity-description">${activity.description}</div>
                        </div>
                        <div class="activity-time">${formatActivityTime(activity.timestamp)}</div>
                    </div>
                `;
            }).join('');
        }

        function formatActivityTime(timestamp) {
            const date = new Date(timestamp);
            return date.toLocaleString('pt-BR', { 
                day: '2-digit', 
                month: '2-digit', 
                hour: '2-digit', 
                minute: '2-digit' 
            });
        }

        // Modals
        function openCourseModal(courseId = null) {
            editingCourseId = courseId;
            const modal = document.getElementById('courseModal');
            const title = document.getElementById('courseModalTitle');
            const form = document.getElementById('courseForm');

            form.reset();

            if (courseId) {
                const course = cursos.find(c => c.id === courseId);
                if (course) {
                    title.textContent = 'Editar Curso';
                    document.getElementById('courseName').value = course.curso || '';
                    document.getElementById('courseIdLote').value = course.idLote || '';
                    document.getElementById('courseLoteResponsavel').value = course.loteResponsavel || '';
                    document.getElementById('courseCity').value = course.cidade || '';
                    document.getElementById('courseLocation').value = course.local || '';
                    document.getElementById('courseStart').value = course.inicio || '';
                    document.getElementById('courseEnd').value = course.fim || '';
                    document.getElementById('courseStatus').value = course.status || 'Pendente';
                    document.getElementById('courseStudents').value = course.alunos || 0;
                    document.getElementById('courseInstructor').value = course.instrutor || '';
                    document.getElementById('courseDriveLink').value = course.driveLink || '';
                }
            } else {
                title.textContent = 'Novo Curso';
            }

            modal.classList.add('active');
        }

        function openInstructorModal(instructorId = null) {
            editingInstructorId = instructorId;
            const modal = document.getElementById('instructorModal');
            const title = document.getElementById('instructorModalTitle');
            const form = document.getElementById('instructorForm');

            form.reset();

            if (instructorId) {
                const instructor = instrutores.find(i => i.id === instructorId);
                if (instructor) {
                    title.textContent = 'Editar Instrutor';
                    document.getElementById('instructorName').value = instructor.nome || '';
                    document.getElementById('instructorSpecialty').value = instructor.especialidade || '';
                    document.getElementById('instructorPhone').value = instructor.telefone || '';
                    document.getElementById('instructorEmail').value = instructor.email || '';
                }
            } else {
                title.textContent = 'Novo Instrutor';
            }

            modal.classList.add('active');
        }

        function openQuickInstructorModal() {
            document.getElementById('quickInstructorForm').reset();
            document.getElementById('quickInstructorModal').classList.add('active');
        }

        function openUserModal(userId = null) {
            editingUserId = userId;
            const modal = document.getElementById('userModal');
            const title = document.getElementById('userModalTitle');
            const form = document.getElementById('userForm');

            form.reset();

            if (userId) {
                const user = users.find(u => u.id === userId);
                if (user) {
                    title.textContent = 'Editar Usuário';
                    document.getElementById('userUsername').value = user.username || '';
                    document.getElementById('userPassword').value = user.password || '';
                    document.getElementById('userRole').value = user.role || 'viewer';
                }
            } else {
                title.textContent = 'Novo Usuário';
            }

            modal.classList.add('active');
        }

        function openReportModal() {
            const modal = document.getElementById('reportModal');
            
            const total = cursos.length;
            const withId = cursos.filter(c => c.idLote).length;
            const concluidos = cursos.filter(c => c.status === 'Concluído').length;
            const concludentes = cursos.reduce((sum, c) => sum + (parseInt(c.alunos) || 0), 0);
            const pendentes = cursos.filter(c => c.status === 'Pendente').length;
            const andamento = cursos.filter(c => c.status === 'Em Andamento').length;

            document.getElementById('reportStats').innerHTML = `
                <div class="report-stat">
                    <div class="report-stat-value">${withId}</div>
                    <div class="report-stat-label">Com ID da Turma</div>
                </div>
                <div class="report-stat">
                    <div class="report-stat-value">${concluidos}</div>
                    <div class="report-stat-label">Concluídos</div>
                </div>
                <div class="report-stat">
                    <div class="report-stat-value">${concludentes}</div>
                    <div class="report-stat-label">Concludentes</div>
                </div>
                <div class="report-stat">
                    <div class="report-stat-value">${pendentes}</div>
                    <div class="report-stat-label">A Realizar</div>
                </div>
                <div class="report-stat">
                    <div class="report-stat-value">${andamento}</div>
                    <div class="report-stat-label">Em Andamento</div>
                </div>
            `;

            // Chart
            if (reportChart) reportChart.destroy();
            
            const ctx = document.getElementById('reportChart').getContext('2d');
            reportChart = new Chart(ctx, {
                type: 'pie',
                data: {
                    labels: ['Concluídos', 'Em Andamento', 'Pendentes', 'Cancelados'],
                    datasets: [{
                        data: [
                            concluidos,
                            andamento,
                            pendentes,
                            cursos.filter(c => c.status === 'Cancelado').length
                        ],
                        backgroundColor: ['#22c55e', '#2563eb', '#f59e0b', '#ef4444']
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'bottom'
                        }
                    }
                }
            });

            modal.classList.add('active');
        }

        function closeModal(modalId) {
            document.getElementById(modalId).classList.remove('active');
        }

        async function downloadReportImage() {
            const content = document.getElementById('reportContent');
            try {
                const canvas = await html2canvas(content, {
                    backgroundColor: '#ffffff',
                    scale: 2
                });
                const link = document.createElement('a');
                link.download = `relatorio-${new Date().toISOString().split('T')[0]}.png`;
                link.href = canvas.toDataURL('image/png');
                link.click();
                showToast('Imagem baixada com sucesso!', 'success');
            } catch (error) {
                console.error('Error generating image:', error);
                showToast('Erro ao gerar imagem', 'error');
            }
        }

        // Form Handlers
        async function handleCourseSubmit(e) {
            e.preventDefault();
            
            const courseData = {
                curso: document.getElementById('courseName').value.trim(),
                idLote: parseInt(document.getElementById('courseIdLote').value) || 0,
                loteResponsavel: document.getElementById('courseLoteResponsavel').value.trim(),
                cidade: document.getElementById('courseCity').value.trim(),
                inicio: document.getElementById('courseStart').value,
                fim: document.getElementById('courseEnd').value,
                status: document.getElementById('courseStatus').value || 'Pendente',
                alunos: parseInt(document.getElementById('courseStudents').value) || 0,
                local: document.getElementById('courseLocation').value.trim(),
                instrutor: document.getElementById('courseInstructor').value,
                driveLink: document.getElementById('courseDriveLink').value.trim()
            };

            try {
                if (editingCourseId) {
                    await db.collection('cursos').doc(editingCourseId).update(courseData);
                    showToast('Curso atualizado com sucesso!', 'success');
                    logActivity('Edição de Curso', `Editou o curso "${courseData.curso}"`, 'edit');
                } else {
                    await db.collection('cursos').add(courseData);
                    showToast('Curso criado com sucesso!', 'success');
                    logActivity('Novo Curso', `Adicionou o curso "${courseData.curso}"`, 'add');
                }
                closeModal('courseModal');
                navigateTo('dashboard');
            } catch (error) {
                console.error('Error saving course:', error);
                showToast('Erro ao salvar curso', 'error');
            }
        }

        async function handleInstructorSubmit(e) {
            e.preventDefault();
            
            const instructorData = {
                nome: document.getElementById('instructorName').value.trim(),
                especialidade: document.getElementById('instructorSpecialty').value.trim(),
                telefone: document.getElementById('instructorPhone').value.trim(),
                email: document.getElementById('instructorEmail').value.trim()
            };

            try {
                if (editingInstructorId) {
                    await db.collection('instrutores').doc(editingInstructorId).update(instructorData);
                    showToast('Instrutor atualizado com sucesso!', 'success');
                    logActivity('Edição de Instrutor', `Editou o instrutor "${instructorData.nome}"`, 'edit');
                } else {
                    await db.collection('instrutores').add(instructorData);
                    showToast('Instrutor criado com sucesso!', 'success');
                    logActivity('Novo Instrutor', `Adicionou o instrutor "${instructorData.nome}"`, 'add');
                }
                closeModal('instructorModal');
            } catch (error) {
                console.error('Error saving instructor:', error);
                showToast('Erro ao salvar instrutor', 'error');
            }
        }

        async function handleQuickInstructorSubmit(e) {
            e.preventDefault();
            
            const nome = document.getElementById('quickInstructorName').value.trim();
            const telefone = document.getElementById('quickInstructorPhone').value.trim();

            try {
                await db.collection('instrutores').add({ nome, telefone });
                showToast('Instrutor adicionado!', 'success');
                logActivity('Novo Instrutor', `Adicionou o instrutor "${nome}" (rápido)`, 'add');
                closeModal('quickInstructorModal');
            } catch (error) {
                console.error('Error adding instructor:', error);
                showToast('Erro ao adicionar instrutor', 'error');
            }
        }

        async function handleUserSubmit(e) {
            e.preventDefault();

            const userData = {
                username: document.getElementById('userUsername').value.trim(),
                password: document.getElementById('userPassword').value,
                role: document.getElementById('userRole').value
            };

            if (editingUserId) {
                const idx = users.findIndex(u => u.id === editingUserId);
                if (idx !== -1) {
                    users[idx] = { ...users[idx], ...userData };
                    logActivity('Edição de Usuário', `Editou o usuário "${userData.username}"`, 'edit');
                }
            } else {
                const newUser = {
                    id: Date.now().toString(),
                    ...userData
                };
                users.push(newUser);
                logActivity('Novo Usuário', `Adicionou o usuário "${userData.username}"`, 'add');
            }

            saveUsers();
            renderUsersTable();
            closeModal('userModal');
            showToast('Usuário salvo com sucesso!', 'success');
        }

        // Delete Functions
        async function deleteCourse(id) {
            if (!confirm('Tem certeza que deseja excluir este curso?')) return;
            
            const course = cursos.find(c => c.id === id);
            try {
                await db.collection('cursos').doc(id).delete();
                showToast('Curso excluído!', 'success');
                logActivity('Exclusão de Curso', `Excluiu o curso "${course?.curso}"`, 'delete');
            } catch (error) {
                console.error('Error deleting course:', error);
                showToast('Erro ao excluir curso', 'error');
            }
        }

        async function deleteInstructor(id) {
            if (!confirm('Tem certeza que deseja excluir este instrutor?')) return;
            
            const instructor = instrutores.find(i => i.id === id);
            try {
                await db.collection('instrutores').doc(id).delete();
                showToast('Instrutor excluído!', 'success');
                logActivity('Exclusão de Instrutor', `Excluiu o instrutor "${instructor?.nome}"`, 'delete');
            } catch (error) {
                console.error('Error deleting instructor:', error);
                showToast('Erro ao excluir instrutor', 'error');
            }
        }

        function deleteUser(id) {
            if (!confirm('Tem certeza que deseja excluir este usuário?')) return;
            
            const user = users.find(u => u.id === id);
            users = users.filter(u => u.id !== id);
            saveUsers();
            renderUsersTable();
            showToast('Usuário excluído!', 'success');
            logActivity('Exclusão de Usuário', `Excluiu o usuário "${user?.username}"`, 'delete');
        }

        // Settings Functions
        async function handleExcelUpload(e) {
            const file = e.target.files[0];
            if (!file) return;

            const reader = new FileReader();
            reader.onload = async (event) => {
                try {
                    const data = new Uint8Array(event.target.result);
                    const workbook = XLSX.read(data, { type: 'array' });
                    const sheet = workbook.Sheets[workbook.SheetNames[0]];
                    const json = XLSX.utils.sheet_to_json(sheet);

                    let imported = 0;
                    for (const row of json) {
                        const courseData = {
                            curso: row['Curso'] || row['curso'] || row['CURSO'] || '',
                            idLote: parseInt(row['ID Lote'] || row['ID da Turma'] || row['id_lote'] || 0),
                            loteResponsavel: row['Lote Responsavel'] || row['LOTE - RESPONSAVEL'] || '',
                            cidade: row['Cidade'] || row['cidade'] || row['CIDADE'] || '',
                            local: row['Local'] || row['local'] || row['LOCAL'] || '',
                            inicio: row['Inicio'] || row['inicio'] || row['Data Inicio'] || '',
                            fim: row['Fim'] || row['fim'] || row['Data Fim'] || '',
                            status: row['Status'] || row['status'] || 'Pendente',
                            alunos: parseInt(row['Alunos'] || row['Concludentes'] || 0),
                            instrutor: row['Instrutor'] || row['instrutor'] || '',
                            driveLink: row['Drive'] || row['Link Drive'] || row['Google Drive'] || ''
                        };

                        if (courseData.curso) {
                            await db.collection('cursos').add(courseData);
                            imported++;
                        }
                    }

                    showToast(`${imported} cursos importados!`, 'success');
                    logActivity('Importação', `Importou ${imported} cursos de planilha`, 'add');
                } catch (error) {
                    console.error('Error importing:', error);
                    showToast('Erro ao importar arquivo', 'error');
                }
            };
            reader.readAsArrayBuffer(file);
            e.target.value = '';
        }

        function exportCoursesToCsv() {
            const headers = ['Curso', 'ID da Turma', 'Lote Responsavel', 'Cidade', 'Local', 'Inicio', 'Fim', 'Status', 'Concludentes', 'Instrutor', 'Google Drive'];
            const rows = cursos.map(c => [
                c.curso, c.idLote, c.loteResponsavel, c.cidade, c.local, c.inicio, c.fim, c.status, c.alunos, c.instrutor, c.driveLink
            ]);

            const csv = [headers, ...rows].map(r => r.map(v => `"${v || ''}"`).join(',')).join('\n');
            downloadFile(csv, 'cursos.csv', 'text/csv');
            logActivity('Exportação', 'Exportou cursos para CSV', 'info');
        }

        function exportInstructorsToCsv() {
            const headers = ['Nome', 'Especialidade', 'Telefone', 'Email'];
            const rows = instrutores.map(i => [i.nome, i.especialidade, i.telefone, i.email]);

            const csv = [headers, ...rows].map(r => r.map(v => `"${v || ''}"`).join(',')).join('\n');
            downloadFile(csv, 'instrutores.csv', 'text/csv');
            logActivity('Exportação', 'Exportou instrutores para CSV', 'info');
        }

        function downloadFile(content, filename, type) {
            const blob = new Blob([content], { type });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = filename;
            a.click();
            URL.revokeObjectURL(url);
        }

        async function clearAllData() {
            if (!confirm('ATENÇÃO: Todos os cursos e instrutores serão excluídos permanentemente. Continuar?')) return;
            if (!confirm('Esta ação não pode ser desfeita. Tem certeza absoluta?')) return;

            try {
                for (const curso of cursos) {
                    await db.collection('cursos').doc(curso.id).delete();
                }
                for (const instrutor of instrutores) {
                    await db.collection('instrutores').doc(instrutor.id).delete();
                }
                showToast('Todos os dados foram excluídos!', 'success');
                logActivity('Limpeza de Dados', 'Excluiu todos os cursos e instrutores', 'delete');
            } catch (error) {
                console.error('Error clearing data:', error);
                showToast('Erro ao limpar dados', 'error');
            }
        }

        // Toast
        function showToast(message, type = 'info') {
            const container = document.getElementById('toastContainer');
            const toast = document.createElement('div');
            toast.className = `toast ${type}`;
            toast.innerHTML = `
                <span class="material-icons">${type === 'success' ? 'check_circle' : type === 'error' ? 'error' : 'info'}</span>
                ${message}
            `;
            container.appendChild(toast);
            setTimeout(() => toast.remove(), 4000);
        }
    </script>
</body>
</html>
